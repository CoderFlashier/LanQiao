C51 COMPILER V9.60.7.0   MAIN                                                              03/17/2024 14:12:29 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: F:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver) DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "timer.h"
   2          #include "led.h"
   3          #include "init.h"
   4          #include "seg.h"
   5          #include "stdio.h"
   6          #include "key.h"
   7          #include "buzz_relay.h"
   8          #include "ds1302.h"
   9          
  10          //Timer
  11          unsigned long ulms = 0;
  12          unsigned int uiLED_Dly = 0;
  13          unsigned int uiSeg_Dly = 0;
  14          unsigned int uiKey_Dly = 0;
  15          unsigned int uiPeripheral_Dly = 0;
  16          unsigned int uiRTC_Dly = 0;
  17          
  18          //LED
  19          unsigned char ucLED = 0x25;
  20          
  21          //Seg
  22          unsigned char ucSeg_Pos = 0;
  23          unsigned char pucSeg_Buf[12], pucSeg_Code[8];
  24          
  25          //Key
  26          unsigned char ucKey_Val = 0;
  27          
  28          //RTC
  29          unsigned char pucRTC[3] = {23, 59, 55};
  30          
  31          //Function
  32          void LED_Proc(void);
  33          void Seg_Proc(void);
  34          void Key_Proc(void);
  35          void Peripheral_Proc(void);
  36          void RTC_Proc(void);
  37          
  38          
  39          void main(void)
  40          {
  41   1        init();
  42   1        Timer0_Init();
  43   1        EA = 1;
  44   1        
  45   1        Set_RTC(pucRTC);
  46   1        
  47   1        while(1)
  48   1        {
  49   2          LED_Proc();
  50   2          Seg_Proc();
  51   2          Key_Proc();
  52   2          RTC_Proc();
  53   2          
  54   2          Peripheral_Proc();
C51 COMPILER V9.60.7.0   MAIN                                                              03/17/2024 14:12:29 PAGE 2   

  55   2        }
  56   1      }
  57          
  58          
  59          void LED_Proc(void)
  60          {
  61   1        if(uiLED_Dly < 200)
  62   1          return;
  63   1        
  64   1        uiLED_Dly = 0;
  65   1        
  66   1        LED_Display(ucLED);
  67   1      }
  68          
  69          void Seg_Proc(void)
  70          {
  71   1        if(uiSeg_Dly < 200)
  72   1          return;
  73   1        
  74   1        uiSeg_Dly = 0;
  75   1        
  76   1        sprintf(pucSeg_Buf, "%02u-%02u-%02u", (unsigned int)pucRTC[0], (unsigned int)pucRTC[1], (unsigned int)puc
             -RTC[2]);
  77   1        Seg_Tran(pucSeg_Buf, pucSeg_Code);
  78   1      }
  79          
  80          
  81          void Key_Proc(void)
  82          {
  83   1        if(uiKey_Dly > 20)
  84   1          return;
  85   1        
  86   1        uiKey_Dly = 0;
  87   1        
  88   1        ucKey_Val = Key_Read_KBD();
  89   1      }
  90          
  91          
  92          void Peripheral_Proc(void)
  93          {
  94   1        if(uiPeripheral_Dly < 500)
  95   1          return;
  96   1        
  97   1        uiPeripheral_Dly = 0;
  98   1        
  99   1        Set_Peripheral(0, 1);
 100   1      }
 101            
 102          
 103          void RTC_Proc(void)
 104          {
 105   1        if(uiRTC_Dly < 500)
 106   1          return;
 107   1        
 108   1        uiRTC_Dly = 0;
 109   1        
 110   1        Get_RTC(pucRTC);
 111   1      }
 112            
 113          
 114          void Timer_0(void) interrupt 1
 115          {
C51 COMPILER V9.60.7.0   MAIN                                                              03/17/2024 14:12:29 PAGE 3   

 116   1        ulms++;
 117   1        uiLED_Dly++;
 118   1        uiSeg_Dly++;
 119   1        uiKey_Dly++;
 120   1        uiPeripheral_Dly++;
 121   1        uiRTC_Dly++;
 122   1        
 123   1        if(ulms % 2 ==0)
 124   1        {
 125   2          ucSeg_Pos = (ucSeg_Pos + 1) % 8;
 126   2          Seg_Display(pucSeg_Code, ucSeg_Pos);
 127   2        }
 128   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    344    ----
   CONSTANT SIZE    =     15    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     40    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
